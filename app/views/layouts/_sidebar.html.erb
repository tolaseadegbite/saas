<%= javascript_include_tag('sidebar.js') %>

<div class="sidebar d-flex flex-column px-3" id="side_nav">
    <!-- Header starts -->
    <div class="header-box pt-3 pb-4 d-flex justify-content-between">
        <h1 class="fs-4">
            <span class="bg-white text-dark rounded shadow px-2 me-2">S</span><span class="text-white">AAS</span>
        </h1>
        <button class="btn d-md-none d-block close-btn px-1 py-0 text-white"><i class="bi bi-list"></i></button>
    </div>
    <!-- Header ends -->

    <!-- Business accordion start -->
    <div class="accordion accordion-flush border rounded border-success" id="accordionFlushExample">
        <div class="accordion-item border rounded border-success" style="background: #09311e;">
            <div class="accordion-header">
                <button class="accordion-button collapsed py-2 px-2 rounded" style="background: #09311e; box-shadow: none" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
                    <div class="d-block fw-medium">
                        <% if controller.controller_name == 'businesses' && (action_name == 'show' || action_name == 'edit' ) %>
                            <div class="m-0 text-white"><small><%= @current_business.name %></small></div>
                            <div class="m-0" style="color: #91af9c"><small>1440630</small></div>
                        <% else %>
                            <div class="m-0 text-white"><small>Search Business</small></div>
                        <% end %>
                    </div>
                </button>
            </div>
            
            <div id="flush-collapseOne" class="accordion-collapse collapse" style="background: #09311e" data-bs-parent="#accordionFlushExample">
                <div class="accordion-body p-0" style="background: #09311e">
                    <h6 class=" text-success py-2 px-2" style="font-size: 11px;">OTHER BUSINESSES - <%= current_user.businesses.count %></h6>

                    <div class="input-group input-group-sm px-2">
                        <span class="input-group-text border-0" style="background: #041c11e3;" id="basic-addon1">
                            <i class="bi bi-search text-secondary"></i>
                        </span>
                        <input type="text" class="form-control border-0 text-white" style="background: #041c11e3; box-shadow: none;" placeholder="Search" aria-label="Search" aria-describedby="basic-addon1">
                    </div>

                    <ul class="list-unstyled px-2">
                        <% current_user.businesses.each do |business| %>
                            <li class="">
                                <%= link_to business.name, business, class: 'text-decoration-none border-bottom border-secondary pt-2 pb-2 d-block', style: 'color: #91af9c' %>
                            </li>
                        <% end %>
                        
                        <li class="">
                            <%= link_to businesses_path, class: "text-decoration-none border-bottom border-secondary ps-0 pt-2 pb-2 d-block w-100 text-start", style: 'color: #91af9c; background: none; border: 0' do %>
                                <i class="bi bi-buildings text-secondary fw-medium"></i>
                                My Businesses
                            <% end %>
                        
                        <li class="">
                            <%= link_to new_business_path, class: "text-decoration-none border-bottom border-secondary ps-0 pt-2 pb-2 d-block w-100 text-start", style: 'color: #91af9c; background: none; border: 0' do %>
                                <i class="bi bi-plus-lg text-secondary fw-medium"></i>
                                Add Business
                            <% end %>
                        </li>
                        </li>

                        <li class="">
                            <%= link_to destroy_user_session_path, data: { "turbo-method": :delete }, class: 'text-decoration-none ps-0 pt-2 pb-2 d-block w-100 text-start', style: 'color: #91af9c; background: none; border: 0' do %>
                                <i class="bi bi-box-arrow-right me-1"></i>
                                Log Out
                            <% end %>
                        </li>

                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- Business accordion ends -->

    <!-- Sidebar navigartion starts -->
    <% if controller.controller_name == 'businesses' && (action_name == 'show' || action_name == 'edit' ) %>
        <ul class="list-unstyled mt-3">
            <li>
                <%= link_to @current_business, class: 'text-decoration-none  py-2 d-block' do %>
                    <i class="bi bi-house-door me-1"></i>
                    Dashboard
                <% end %>
            </li>

            <li class="">
                <a href="#" class="text-decoration-none  py-2 d-block">
                    <i class="bi bi-shop me-1"></i>
                    Stores
                </a>
            </li>

            <li class="">
                <a href="#" class="text-decoration-none  py-2 d-block">
                    <i class="bi bi-cart4 me-1"></i>
                    Products
                </a>
            </li>

            <li class="">
                <a href="#" class="text-decoration-none  py-2 d-block">
                    <i class="bi bi-people me-1"></i>
                    Customers
                </a>
            </li>
            
        </ul>

        <!--
        <hr class="h-color mx-2">
        -->

        <ul class="list-unstyled mt-auto border-top border-secondary pt-3">
            <li class="">
                <a href="#" class="text-decoration-none  py-2 d-block">
                    <i class="bi bi-graph-up-arrow me-1"></i>
                    Analytics
                </a>
            </li>

            <li class="">
                <%= link_to edit_business_path(@current_business), class: 'text-decoration-none  py-2 d-block' do %>
                    <i class="bi bi-gear"></i>
                    Business Settings
                <% end %>
            </li>

        </ul>
        <!-- Sidebar navigation ends -->
    <% end %>

</div>

<!-- business modal starts -->
<div class="modal" id="businessModal" tabindex="-1" aria-labelledby="businessModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header border-bottom-0">
        <button type="button" class="btn-close mx-0 close-modal-btn" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <h1 class="h4">New Business</h1>
        <%= render 'shared/business_form', form_submit_path: businesses_path, button_label: "Create business" %>
      </div>
    </div>
  </div>
</div>
<!-- business modal ends -->